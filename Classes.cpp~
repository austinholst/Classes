//Classes.cpp
#include <iostream>
#include "Media.h"
#include <cstring>
#include <vector>
#include <string.h>
#include "VideoGames.h"
#inlcude "Music.h"

using namespace std;

vector<Media*> vect;

void add(vector<Media*> &vect);
void search(vector<Media*> &vect);
void erase(vector<Media*> &vect);

int main() {
  
  char input[10];
  bool running = true;
  
  while(running == true) {
    cout << "Do you want to add search delete or quit" << endl;
    cin.getline(input, 10);
    for(int i = 0; i < 10; i++) {
      input[i]  = tolower(input[i]);
    }
    if(strcmp(input, "add") == 0) {
      add(vect);
    }
    else if(strcmp(input, "search") == 0) {
      search(vect);
    }
    else if(strcmp(input, "delete") == 0) {
      erase(vect);
    }
    else if(strcmp(input, "quit") == 0) {
      cout << "quiting program" << endl;
      running = false;
    }
    else {
      cout << "You can only use these commands: add search delete quit" << endl;
    }
  }
  return 0;
}


void add(vector<Media*> &vect) {
  char mediaType[20];
  cout << "What type of media do you want to add?" << endl;
  cin.getline(mediaType, 20);
  for(int i = 0; i < 20; i++) {
    mediaType[i] = tolower(mediaType[i]);
  }
  if(strcmp(mediaType, "video game") == 0) {
    char*  title = new char[100];
    int year;
    char* publisher = new char[100];
    int rating;; 

    cout << "What is the title of the game?" << endl;
    cin.getline(title, 100);
    cout << "What year did the game come out?" << endl;
    cin >> year;
    cin.ignore();
    cout << "Who published the game?" << endl;
    cin.getline(publisher, 100);
    cout << "On a scale of 1-10, what would you rate the game?" << endl;
    cin >> rating;
    cin.ignore();

    VideoGames* videoGamesPointer = new VideoGames(publisher, year, rating, title);
    vect.push_back(videoGamesPointer);
  }
  else if(strcmp(mediaType, "movie") == 0) {
    char* title = new char[100];
    int year;
    char* publisher = new char[100];
    char* artist = new char[100];
    int duration;

    cout << "What is the title of the song?" << endl;
    cin.getline(title, 100);
    cout << "What year did the song come out" << endl;
  }
  else if(strcmp(mediaType, "music") == 0) {
    cout << "You want to add Music" << endl;
  }
  else {
    cout << "You can't add that type of media" << endl;
  }
}

void search(vector<Media*> &vect) {
  cout << "Would you like to search by Title or Year" << endl;
  char answer[10];
  cin.getline(answer, 10);
  for(int i = 0; i < 10; i++) {
    answer[i] = tolower(answer[i]);
  }
  if(strcmp(answer, "title") == 0) {
    cout << "What is the title of the media" << endl;
    char temp[100];
    cin.getline(temp, 100);
    for(vector<Media*>::iterator it = vect.begin(); it != vect.end(); it++) {
      if(strcmp(temp, (*it)-> getTitle()) == 0) {
	cout << "Title: " << (*it)-> getTitle() << endl;
	cout << "Year Released: " << (*it)-> getYear() << endl;
	cout << "Publisher: " << (*it)-> getPublisher() << endl;
	cout << "You rated the game " << (*it)-> getRating() << " " << "out of 10" << endl;
      }
      else {
	cout << "That media is not found" << endl;
      }
    }  
  }
  else if(strcmp(answer, "year") == 0) {
    cout << "What is the year of the media" << endl;
    int number = 0;
    cin >> number;
    cin.ignore(10, '\n');
    for(vector<Media*>::iterator it = vect.begin(); it != vect.end(); it++) {
      if((*it)-> getYear() == number) {
	cout << "Title: " << (*it)-> getTitle() << endl;
	cout << "Year Released: " << (*it)-> getYear() << endl;
	cout << "Publisher: " << (*it)-> getPublisher() << endl;
	cout << "You rated the game: " << (*it)-> getRating() << " " << "out of 10" << endl;
      }
      else {
	cout << "That media is not found" << endl;
      }
    }
  }
  else {
    cout << "You have to search by title or by year" << endl;
  }
  //Casting the type media into a video game(Not using this but just so I know how)
  //static_cast<VideoGames*>(*it)-> getRating()
}

void erase(vector<Media*> &vect) {
  cout << "Would you like to delete by title or year" << endl;
  char answer[10];
  cin.getline(answer, 100);
  for(int i = 0; i < 10; i++) {
    answer[i] = tolower(answer[i]);
  }
  if(strcmp(answer, "title") == 0) {
    cout << "What is the title of the media" << endl;
    char temp[100];
    cin.getline(temp, 100);
    for(vector<Media*>::iterator it = vect.begin(); it != vect.end(); it++) {
      int position = it - vect.begin();
      if(strcmp(answer, (*it)-> getTitle()) == 0) {
	  delete static_cast<VideoGames*>(*it);
	  vect.erase(vect.begin() + position);
	  cout << "That media has been terminated" << endl;
	  break;
      }
    }
  }
  else if(strcmp(answer, "year") == 0) {
    cout << "What is the year of the media" << endl;
    int  number = 0;
    cin >> number;
    cin.ignore(10, '\n');
    for(vector<Media*>::iterator it = vect.begin(); it != vect.end(); it++) {
      int position = it - vect.begin();
      if((*it)-> getYear() == number) {
	delete static_cast<VideoGames*>(*it);
	vect.erase(vect.begin() + position);
	cout << "That media has been terminated" << endl;
	break;
      }
    }
  }
}

